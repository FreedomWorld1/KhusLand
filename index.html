<!DOCTYPE html>
<html>
<head>
    <title>Firebase Direkttest</title>
</head>
<body>
    <h1>üî• Firebase Direkttest</h1>
    
    <button onclick="testDirect()">üîó Direktverbindung testen</button>
    <button onclick="testCors()">üîÑ CORS Umgehung testen</button>
    <button onclick="testJson()">üì° JSON Direktzugriff</button>
    
    <div id="result" style="margin-top:20px;padding:20px;background:#f0f0f0;"></div>
    
    <script>
        // DEINE FIREBASE URL
        const FIREBASE_URL = 'https://cc-shop-36c3b-default-rtdb.europe-west1.firebasedatabase.app';
        
        async function testDirect() {
            try {
                const result = document.getElementById('result');
                result.innerHTML = '<p style="color:blue">‚è≥ Teste direkte Verbindung...</p>';
                
                // Direkter Fetch ohne Firebase SDK
                const response = await fetch(`${FIREBASE_URL}/test.json`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        test: true,
                        timestamp: new Date().toISOString(),
                        message: 'Direkter Test von CC-Shop'
                    })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    result.innerHTML = `
                        <div style="color:green;border:2px solid green;padding:15px;">
                        <h3>‚úÖ DIREKTE VERBINDUNG FUNKTIONIERT!</h3>
                        <pre>${JSON.stringify(data, null, 2)}</pre>
                        </div>
                    `;
                    console.log('‚úÖ Direktzugriff erfolgreich:', data);
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
            } catch (error) {
                document.getElementById('result').innerHTML = `
                    <div style="color:red;border:2px solid red;padding:15px;">
                    <h3>‚ùå FEHLER: ${error.message}</h3>
                    <p>Problem: CORS oder Firebase-Regeln blockieren</p>
                    </div>
                `;
                console.error('‚ùå Direktzugriff fehlgeschlagen:', error);
            }
        }
        
        async function testCors() {
            try {
                // CORS Proxy verwenden
                const proxyUrl = 'https://cors-anywhere.herokuapp.com/';
                const targetUrl = `${FIREBASE_URL}/test.json`;
                
                const response = await fetch(proxyUrl + targetUrl, {
                    method: 'GET'
                });
                
                if (response.ok) {
                    const data = await response.json();
                    alert(`‚úÖ CORS Proxy funktioniert!\nDaten: ${JSON.stringify(data)}`);
                }
            } catch (error) {
                console.error('CORS Proxy Fehler:', error);
            }
        }
        
        async function testJson() {
            // Einfachste Methode: JSON direkt laden
            const url = `${FIREBASE_URL}/.json`;
            document.getElementById('result').innerHTML = `
                <p>üì° Versuche JSON zu laden: <a href="${url}" target="_blank">${url}</a></p>
                <iframe src="${url}" width="100%" height="300"></iframe>
            `;
        }
    </script>
</body>
</html>

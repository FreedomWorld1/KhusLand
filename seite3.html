<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title id="htmlTitle">KhusLand Bestellrechner</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
  :root {
    --card-bg: rgba(255,255,255,0.03);
    --card-border: rgba(255,255,255,0.06);
    --accent: #3b82f6;
  }
  body { font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; }
  .tabs-slider {
    position: absolute;
    height: 100%;
    left: 0;
    width: 0;
    border-radius: 0.75rem;
    transition: left .25s ease, width .25s ease, background-color .25s ease;
    z-index: 5;
    box-shadow: 0 6px 20px rgba(0,0,0,0.4);
    opacity: .95;
  }
  .category-card {
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border: 1px solid var(--card-border);
    border-radius: 0.75rem;
  }
  .quantity-control button { width: 42px; height: 42px; display:flex; align-items:center; justify-content:center; }
  #kopiertHinweis { transition: opacity .2s ease; }
  @media (max-width: 640px) {
      .tabs-container { gap: .25rem; }
  }
</style>
</head>
<body class="bg-gray-900 text-gray-100 antialiased">
<div class="min-h-screen px-4 py-8">
  <div class="max-w-6xl mx-auto">
    <div class="bg-gradient-to-b from-gray-900 to-gray-800 shadow-2xl rounded-2xl p-6">
      <div class="flex flex-col md:flex-row items-start justify-between gap-6">
        <!-- Tabs + Slider -->
        <div class="flex-1 min-w-0">
          <h4 class="text-xl font-bold text-blue-400">Bestellseiten</h4>
          <div class="relative mt-3">
            <div id="tabsContainer" class="tabs-container flex gap-3 relative p-1">
              <div id="tabsSlider" class="tabs-slider rounded-lg"></div>
              <!-- Buttons werden von JS erzeugt -->
            </div>
          </div>
        </div>

        <!-- Logo + Seitenmenü -->
        <div class="flex flex-col items-center">
          <img id="headerImage" src="https://via.placeholder.com/150" alt="Logo" class="rounded-lg shadow-lg mb-2 w-[110px] h-[110px] object-cover" />
          <h2 id="calculatorTitle" class="text-2xl font-extrabold text-gray-100 whitespace-nowrap">🌴 KhusLand Bestellrechner 🌴</h2>
          <!-- Drei-Striche-Seitenmenü -->
          <div class="flex justify-center gap-3 mt-4 mb-6">
            <a href="seite1.html" class="tab-page px-4 py-2 rounded-md text-white bg-gray-700 hover:bg-gray-600">Seite 1</a>
            <a href="seite2.html" class="tab-page px-4 py-2 rounded-md text-white bg-gray-700 hover:bg-gray-600">Seite 2</a>
            <a href="seite3.html" class="tab-page px-4 py-2 rounded-md text-white bg-blue-600">Seite 3</a>
            <a href="seite4.html" class="tab-page px-4 py-2 rounded-md text-white bg-gray-700 hover:bg-gray-600">Seite 4</a>
          </div>
        </div>

        <!-- Theme Toggle + Settings -->
        <div class="flex items-center space-x-3">
          <label class="text-sm">🌞</label>
          <label class="relative inline-flex items-center cursor-pointer">
            <input type="checkbox" id="themeToggle" class="sr-only" onchange="toggleTheme()">
            <div class="w-11 h-6 bg-gray-600 rounded-full peer-checked:bg-blue-600 relative after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:h-5 after:w-5 after:rounded-full after:transition-all"></div>
          </label>
          <label class="text-sm">🌙</label>
          <button onclick="openSettings()" class="ml-2 px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg text-sm font-semibold">⚙️</button>
        </div>
      </div>

      <!-- Calculator Content -->
      <div id="calculatorContent" class="mt-6">
        <div id="categoriesGrid" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6"></div>
        <div class="mt-6 p-4 rounded-lg bg-gray-800 border border-gray-700">
          <div class="flex justify-between items-center">
            <div>
              <div class="text-sm font-semibold text-gray-300">Grund:</div>
              <div id="grund" class="text-base text-gray-100 mt-1 whitespace-pre-wrap">Noch nichts berechnet</div>
            </div>
            <div class="text-right">
              <div class="text-sm font-semibold text-gray-300">Preis</div>
              <div id="preis" class="text-2xl font-extrabold text-blue-400 mt-1">0$</div>
            </div>
          </div>
          <div class="mt-3 flex items-center justify-between">
            <div class="flex items-center space-x-3">
              <label class="font-semibold">Personen:</label>
              <div class="quantity-control inline-flex items-center rounded-md overflow-hidden bg-gray-700">
                <button onclick="changeQuantity('personCountInput', -1)" class="px-3 text-xl">−</button>
                <input id="personCountInput" type="number" min="0" value="0" oninput="berechne()" class="w-20 text-center bg-gray-800 border-l border-r border-gray-700 outline-none px-2 py-2" />
                <button onclick="changeQuantity('personCountInput', 1)" class="px-3 text-xl">+</button>
              </div>
            </div>
            <div class="flex items-center space-x-3">
              <button onclick="resetRechner()" class="px-4 py-2 bg-red-600 hover:bg-red-500 rounded-md font-semibold">Reset</button>
              <button onclick="copyText('grund')" class="px-3 py-2 bg-gray-700 rounded-md">📄 Grund</button>
              <button onclick="copyPriceText()" class="px-3 py-2 bg-gray-700 rounded-md">📄 Preis</button>
            </div>
          </div>
          <div id="kopiertHinweis" class="text-sm text-green-400 text-center hidden mt-3">Kopiert ✅</div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Loading Overlay -->
<div id="loadingOverlay" class="fixed inset-0 flex items-center justify-center z-40 bg-black/60 hidden">
  <div class="loading-spinner border-4 border-gray-700 border-t-4 border-t-blue-500 rounded-full w-10 h-10 animate-spin"></div>
</div>

<script>
/* --------------------------
   Konfiguration / Default
--------------------------*/
const defaultPreise = {
  beluga: { name: 'Beluga Kaviar', price: 300, category: 'SPEISEN', id: 'beluga' },
  doener: { name: 'Fischdöner', price: 175, category: 'SPEISEN', id: 'doener' },
  bowl: { name: 'Seafood Bowl', price: 175, category: 'SPEISEN', id: 'bowl' },
  fiji: { name: 'Fiji Wasser', price: 75, category: 'GETRÄNKE', id: 'fiji' },
  cola: { name: 'Cola Cherry', price: 60, category: 'GETRÄNKE', id: 'cola' },
  dom: { name: 'Dom Perignon', price: 400, category: 'ALKOHOL', id: 'dom' },
  kuchen: { name: 'Kuchen', price: 400, category: 'DESSERTS', id: 'kuchen' },
  rose: { name: 'Ecla Lune Rose 1L', price: 10000, category: 'PREMIUM', id: 'rose' },
  vape: { name: 'Vape', price: 100, category: 'RAUCHWAREN', id: 'vape' }
};
let currentPreise = {...defaultPreise};
let categories = ['SPEISEN','GETRÄNKE','ALKOHOL','DESSERTS','PREMIUM','RAUCHWAREN'];
let foodCategories = ['SPEISEN','DESSERTS'], drinkCategories = ['GETRÄNKE','ALKOHOL'], rauchwarenCategories=['RAUCHWAREN'], miscellaneousCategories=['PREMIUM'];
let activeTab = 1, calculatorStates={}, numTabs=5;

/* --------------------------
   Tabs + Slider
--------------------------*/
function renderTabs(){
  const tabsContainer = document.getElementById('tabsContainer');
  tabsContainer.querySelectorAll('.tab-button').forEach(n=>n.remove());
  const slider = document.getElementById('tabsSlider');
  slider.style.width = '0px';

  categories.forEach((cat, idx) => {
    const btn = document.createElement('button');
    btn.className = 'tab-button relative z-10 px-4 py-2 text-sm font-medium rounded-lg text-gray-100';
    btn.dataset.tab = String(idx+1);
    btn.dataset.cat = cat;
    btn.innerText = cat;
    btn.onclick = ()=>switchTab(idx+1);
    tabsContainer.appendChild(btn);
  });

  setTimeout(()=>{ // activate first
    const first = tabsContainer.querySelector('.tab-button[data-tab="'+activeTab+'"]');
    if(first){ first.classList.add('active'); updateSliderPosition(first); }
  },50);
}

function updateSliderPosition(tabButton){
  const slider = document.getElementById('tabsSlider');
  const tabsContainer = document.getElementById('tabsContainer');
  tabsContainer.style.position = 'relative';
  if(tabButton && slider){
    const buttonRect = tabButton.getBoundingClientRect();
    const containerRect = tabsContainer.getBoundingClientRect();
    slider.style.left = `${buttonRect.left - containerRect.left}px`;
    slider.style.width = `${buttonRect.width}px`;
    updateSliderBasedOnActive();
  }
}

function updateSliderBasedOnActive(){
  const slider = document.getElementById('tabsSlider');
  const activeBtn = document.querySelector(`.tab-button[data-tab="${activeTab}"]`);
  if(!activeBtn || !slider) return;
  const cat = activeBtn.dataset.cat.toUpperCase();
  let gradient='';
  switch(cat){
    case 'RAUCHWAREN': gradient='linear-gradient(90deg,#f43f5e,#ef4444)'; break;
    case 'PREMIUM': gradient='linear-gradient(90deg,#f59e0b,#d97706)'; break;
    case 'DESSERTS': gradient='linear-gradient(90deg,#a78bfa,#7c3aed)'; break;
    case 'ALKOHOL': gradient='linear-gradient(90deg,#f97316,#ea580c)'; break;
    case 'GETRÄNKE': gradient='linear-gradient(90deg,#3b82f6,#1e40af)'; break;
    case 'SPEISEN': gradient='linear-gradient(90deg,#10b981,#059669)'; break;
    default: gradient='linear-gradient(90deg,#3b82f6,#1e40af)';
  }
  slider.style.background = gradient;
}

function switchTab(tabNumber){
  if(tabNumber===activeTab) return;
  document.querySelectorAll('.tab-button').forEach(btn=>btn.classList.remove('active'));
  const newBtn=document.querySelector(`.tab-button[data-tab="${tabNumber}"]`);
  if(newBtn){ newBtn.classList.add('active'); updateSliderPosition(newBtn); }
  activeTab=tabNumber;
}

/* --------------------------
   Render Calculator Cards
--------------------------*/
function renderCalculatorInputs(){
  const container = document.getElementById('categoriesGrid');
  container.innerHTML='';
  Object.values(currentPreise).forEach(item=>{
    const card = document.createElement('div');
    card.className='category-card p-4 flex flex-col gap-2';
    card.innerHTML=`
      <div class="font-semibold text-gray-100">${item.name}</div>
      <div class="text-sm text-gray-400">Preis: ${item.price}$</div>
      <div class="quantity-control flex items-center mt-2 gap-2">
        <button onclick="changeItem('${item.id}', -1)">−</button>
        <input id="input-${item.id}" type="number" min="0" value="${calculatorStates[item.id]||0}" class="w-16 text-center bg-gray-800 border border-gray-700 rounded-md" oninput="berechne()">
        <button onclick="changeItem('${item.id}', 1)">+</button>
      </div>
    `;
    container.appendChild(card);
  });
}

/* --------------------------
   Calculator Functions
--------------------------*/
function changeItem(id, delta){
  calculatorStates[id] = Math.max(0,(calculatorStates[id]||0)+delta);
  document.getElementById('input-'+id).value=calculatorStates[id];
  berechne();
}

function changeQuantity(inputId, delta){
  const input = document.getElementById(inputId);
  input.value = Math.max(0, parseInt(input.value||0)+delta);
  berechne();
}

function berechne(){
  let grund='', preis=0;
  Object.keys(calculatorStates).forEach(k=>{
    if(calculatorStates[k]>0){
      grund+=`${currentPreise[k].name} x ${calculatorStates[k]}\n`;
      preis+=currentPreise[k].price*calculatorStates[k];
    }
  });
  const personCount = parseInt(document.getElementById('personCountInput').value||0);
  if(personCount>0){ grund+='Personen: '+personCount+'\n'; preis*=personCount; }
  document.getElementById('grund').innerText=grund||'Noch nichts berechnet';
  document.getElementById('preis').innerText=preis+'$';
}

function resetRechner(){
  Object.keys(calculatorStates).forEach(k=>calculatorStates[k]=0);
  document.getElementById('personCountInput').value=0;
  renderCalculatorInputs();
  berechne();
}

/* --------------------------
   Copy Functions
--------------------------*/
function copyText(id){
  navigator.clipboard.writeText(document.getElementById(id).innerText);
  const hinweis=document.getElementById('kopiertHinweis');
  hinweis.classList.remove('hidden');
  setTimeout(()=>hinweis.classList.add('hidden'),1200);
}

function copyPriceText(){
  navigator.clipboard.writeText(document.getElementById('preis').innerText);
  const hinweis=document.getElementById('kopiertHinweis');
  hinweis.classList.remove('hidden');
  setTimeout(()=>hinweis.classList.add('hidden'),1200);
}

/* --------------------------
   Theme Toggle
--------------------------*/
function toggleTheme(){
  document.body.classList.toggle('dark');
}

/* --------------------------
   Settings
--------------------------*/
function openSettings(){
  alert('Einstellungen hier öffnen (Demo)');
}

/* --------------------------
   Initial Setup
--------------------------*/
window.addEventListener('load',()=>{
  renderTabs();
  renderCalculatorInputs();
  berechne();
});
</script>
</body>
</html>

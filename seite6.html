<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kartell Bewerbung - Admin System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            color: #e6e6e6;
        }
        
        .card {
            background: rgba(25, 25, 35, 0.7);
            backdrop-filter: blur(10px);
            border-radius: 10px;
            border: 1px solid rgba(255, 0, 0, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        
        .blood-effect {
            position: relative;
            overflow: hidden;
        }
        
        .blood-effect::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, transparent 30%, rgba(139, 0, 0, 0.1) 50%, transparent 70%);
            opacity: 0;
            transition: opacity 0.5s;
            pointer-events: none;
        }
        
        .blood-effect.active::before {
            opacity: 1;
            animation: blood-drip 2s forwards;
        }
        
        @keyframes blood-drip {
            0% { transform: translateY(-100%); opacity: 0; }
            50% { transform: translateY(0); opacity: 0.7; }
            100% { transform: translateY(100%); opacity: 0; }
        }
        
        .bullet-hole {
            position: absolute;
            width: 20px;
            height: 20px;
            background: radial-gradient(circle, #8B0000 0%, transparent 70%);
            border-radius: 50%;
            opacity: 0;
            transform: scale(0);
            transition: all 0.5s;
        }
        
        .bullet-hole.active {
            opacity: 1;
            transform: scale(1);
        }
        
        .pulse-red {
            animation: pulse-red 2s infinite;
        }
        
        @keyframes pulse-red {
            0% { box-shadow: 0 0 0 0 rgba(220, 38, 38, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(220, 38, 38, 0); }
            100% { box-shadow: 0 0 0 0 rgba(220, 38, 38, 0); }
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);
            transition: all 0.3s;
        }
        
        .btn-danger:hover {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(220, 38, 38, 0.4);
        }
        
        .tab-active {
            background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);
            color: white;
            font-weight: bold;
        }
        
        .progress-bar {
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #dc2626 0%, #ef4444 100%);
            width: 0%;
            transition: width 0.5s;
        }
        
        .hidden-section {
            display: none;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s;
        }
        
        .active-section {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }
        
        .question-card {
            transition: all 0.3s;
            border-left: 4px solid transparent;
        }
        
        .question-card:hover {
            border-left-color: #dc2626;
            transform: translateX(5px);
        }
        
        .skull-icon {
            filter: drop-shadow(0 0 5px rgba(220, 38, 38, 0.5));
        }
        
        .result-passed {
            background: linear-gradient(135deg, rgba(21, 128, 61, 0.3) 0%, rgba(22, 163, 74, 0.1) 100%);
            border-color: rgba(34, 197, 94, 0.5);
        }
        
        .result-failed {
            background: linear-gradient(135deg, rgba(185, 28, 28, 0.3) 0%, rgba(220, 38, 38, 0.1) 100%);
            border-color: rgba(239, 68, 68, 0.5);
        }
        
        .admin-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .admin-table th, .admin-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .admin-table th {
            background-color: rgba(220, 38, 38, 0.2);
            font-weight: 600;
        }
        
        .admin-table tr:hover {
            background-color: rgba(255, 255, 255, 0.05);
        }
        
        .pin-input {
            letter-spacing: 5px;
            font-family: monospace;
            font-size: 1.5rem;
            text-align: center;
        }
    </style>
</head>
<body class="min-h-screen py-8 px-4">
    <div class="max-w-6xl mx-auto">
        <!-- Header -->
        <header class="card p-6 mb-8 text-center relative blood-effect">
            <div class="flex items-center justify-center gap-4 mb-4">
                <div class="skull-icon text-4xl">
                    <i class="fas fa-skull"></i>
                </div>
                <h1 class="text-3xl md:text-4xl font-bold bg-gradient-to-r from-red-600 to-red-400 bg-clip-text text-transparent">
                    Kartell Bewerbung
                </h1>
                <div class="skull-icon text-4xl">
                    <i class="fas fa-skull"></i>
                </div>
            </div>
            <p class="text-gray-300 max-w-2xl mx-auto">
                Willkommen bei der Bewerbung für die Organisation. Deine Antworten werden streng vertraulich behandelt. 
                Sei ehrlich und präzise in deinen Antworten.
            </p>
            
            <!-- Progress Bar -->
            <div class="mt-6">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <div class="flex justify-between text-sm text-gray-400 mt-2">
                    <span>Standard Fragen</span>
                    <span>Situative Fragen</span>
                    <span>Stressfragen</span>
                    <span>Ergebnis</span>
                </div>
            </div>
        </header>

        <!-- Navigation Tabs -->
        <div class="flex flex-wrap gap-2 mb-6 justify-center">
            <button class="tab-btn px-4 py-2 rounded-lg tab-active" data-tab="standard">
                <i class="fas fa-user mr-2"></i>Standard Fragen
            </button>
            <button class="tab-btn px-4 py-2 rounded-lg bg-gray-800 hover:bg-gray-700" data-tab="situative">
                <i class="fas fa-brain mr-2"></i>Situative Fragen
            </button>
            <button class="tab-btn px-4 py-2 rounded-lg bg-gray-800 hover:bg-gray-700" data-tab="stress">
                <i class="fas fa-fire mr-2"></i>Stressfragen
            </button>
            <button class="tab-btn px-4 py-2 rounded-lg bg-gray-800 hover:bg-gray-700" data-tab="result">
                <i class="fas fa-trophy mr-2"></i>Ergebnis
            </button>
            <button class="tab-btn px-4 py-2 rounded-lg bg-blue-800 hover:bg-blue-700" data-tab="admin">
                <i class="fas fa-lock mr-2"></i>Admin Bereich
            </button>
        </div>

        <!-- Standard Questions Section -->
        <section id="standard" class="card p-6 active-section">
            <h2 class="text-2xl font-bold mb-6 text-red-400 flex items-center gap-2">
                <i class="fas fa-user"></i>
                Standard Fragen
            </h2>
            
            <form id="standardForm" class="space-y-6">
                <div class="question-card p-4 rounded-lg bg-gray-800/50">
                    <label class="block text-lg font-medium mb-2">Name</label>
                    <input type="text" class="w-full p-3 rounded-lg bg-gray-700 border border-gray-600 focus:border-red-500 focus:outline-none" required>
                </div>
                
                <div class="question-card p-4 rounded-lg bg-gray-800/50">
                    <label class="block text-lg font-medium mb-2">Alter & Herkunft</label>
                    <input type="text" class="w-full p-3 rounded-lg bg-gray-700 border border-gray-600 focus:border-red-500 focus:outline-none" required>
                </div>
                
                <div class="question-card p-4 rounded-lg bg-gray-800/50">
                    <label class="block text-lg font-medium mb-2">Familien- oder Hintergrundgeschichte</label>
                    <textarea class="w-full p-3 rounded-lg bg-gray-700 border border-gray-600 focus:border-red-500 focus:outline-none" rows="3" required></textarea>
                </div>
                
                <div class="question-card p-4 rounded-lg bg-gray-800/50">
                    <label class="block text-lg font-medium mb-2">Motivation</label>
                    <textarea class="w-full p-3 rounded-lg bg-gray-700 border border-gray-600 focus:border-red-500 focus:outline-none" rows="3" required></textarea>
                </div>
                
                <div class="question-card p-4 rounded-lg bg-gray-800/50">
                    <label class="block text-lg font-medium mb-2">Fähigkeiten & Talente</label>
                    <textarea class="w-full p-3 rounded-lg bg-gray-700 border border-gray-600 focus:border-red-500 focus:outline-none" rows="3" required></textarea>
                </div>
                
                <div class="question-card p-4 rounded-lg bg-gray-800/50">
                    <label class="block text-lg font-medium mb-2">Schwächen</label>
                    <textarea class="w-full p-3 rounded-lg bg-gray-700 border border-gray-600 focus:border-red-500 focus:outline-none" rows="2" required></textarea>
                </div>
                
                <div class="question-card p-4 rounded-lg bg-gray-800/50">
                    <label class="block text-lg font-medium mb-2">Werte & Loyalität</label>
                    <textarea class="w-full p-3 rounded-lg bg-gray-700 border border-gray-600 focus:border-red-500 focus:outline-none" rows="2" required></textarea>
                </div>
                
                <div class="question-card p-4 rounded-lg bg-gray-800/50">
                    <label class="block text-lg font-medium mb-2">Langfristige Ziele</label>
                    <textarea class="w-full p-3 rounded-lg bg-gray-700 border border-gray-600 focus:border-red-500 focus:outline-none" rows="2" required></textarea>
                </div>
                
                <div class="question-card p-4 rounded-lg bg-gray-800/50">
                    <label class="block text-lg font-medium mb-2">Wie soll die Familie / Kushland von dir profitieren?</label>
                    <textarea class="w-full p-3 rounded-lg bg-gray-700 border border-gray-600 focus:border-red-500 focus:outline-none" rows="2" required></textarea>
                </div>
                
                <div class="flex justify-end mt-8">
                    <button type="button" class="btn-next px-6 py-3 rounded-lg btn-danger font-medium flex items-center gap-2">
                        Weiter zu Situative Fragen
                        <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </form>
        </section>

        <!-- Situative Questions Section -->
        <section id="situative" class="card p-6 hidden-section">
            <h2 class="text-2xl font-bold mb-6 text-red-400 flex items-center gap-2">
                <i class="fas fa-brain"></i>
                Situative Fragen
            </h2>
            
            <form id="situativeForm" class="space-y-6">
                <div class="question-card p-4 rounded-lg bg-gray-800/50">
                    <label class="block text-lg font-medium mb-2">Ein Fremder spricht dich in der Stadt an und fragt, ob du jemanden aus dem Kartell kennst. Wie reagierst du?</label>
                    <textarea class="w-full p-3 rounded-lg bg-gray-700 border border-gray-600 focus:border-red-500 focus:outline-none" rows="3" required></textarea>
                </div>
                
                <div class="question-card p-4 rounded-lg bg-gray-800/50">
                    <label class="block text-lg font-medium mb-2">Ein Kunde weigert sich, den vereinbarten Preis für eine Lieferung zu zahlen. Wie gehst du mit ihm um?</label>
                    <textarea class="w-full p-3 rounded-lg bg-gray-700 border border-gray-600 focus:border-red-500 focus:outline-none" rows="3" required></textarea>
                </div>
                
                <div class="question-card p-4 rounded-lg bg-gray-800/50">
                    <label class="block text-lg font-medium mb-2">Ein anderer versucht, dich für seine Organisation abzuwerben. Wie antwortest du ihm?</label>
                    <textarea class="w-full p-3 rounded-lg bg-gray-700 border border-gray-600 focus:border-red-500 focus:outline-none" rows="3" required></textarea>
                </div>
                
                <div class="question-card p-4 rounded-lg bg-gray-800/50">
                    <label class="block text-lg font-medium mb-2">Du musst neue Kontakte in der Stadt aufbauen, um Geschäfte für das Kartell / Kushland zu sichern. Wie würdest du vorgehen?</label>
                    <textarea class="w-full p-3 rounded-lg bg-gray-700 border border-gray-600 focus:border-red-500 focus:outline-none" rows="3" required></textarea>
                </div>
                
                <div class="flex justify-between mt-8">
                    <button type="button" class="btn-prev px-6 py-3 rounded-lg bg-gray-700 hover:bg-gray-600 font-medium flex items-center gap-2">
                        <i class="fas fa-arrow-left"></i>
                        Zurück
                    </button>
                    <button type="button" class="btn-next px-6 py-3 rounded-lg btn-danger font-medium flex items-center gap-2">
                        Weiter zu Stressfragen
                        <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </form>
        </section>

        <!-- Stress Questions Section -->
        <section id="stress" class="card p-6 hidden-section">
            <h2 class="text-2xl font-bold mb-6 text-red-400 flex items-center gap-2">
                <i class="fas fa-fire"></i>
                Stressfragen
            </h2>
            
            <form id="stressForm" class="space-y-6">
                <div class="question-card p-4 rounded-lg bg-gray-800/50">
                    <label class="block text-lg font-medium mb-2">Ein gegnerisches Kartell bietet dir viel Geld für Infos – deine Entscheidung?</label>
                    <textarea class="w-full p-3 rounded-lg bg-gray-700 border border-gray-600 focus:border-red-500 focus:outline-none" rows="3" required></textarea>
                </div>
                
                <div class="question-card p-4 rounded-lg bg-gray-800/50">
                    <label class="block text-lg font-medium mb-2">Du bist allein und wirst von 3 bewaffneten Leuten abgefangen – deine Handlung?</label>
                    <textarea class="w-full p-3 rounded-lg bg-gray-700 border border-gray-600 focus:border-red-500 focus:outline-none" rows="3" required></textarea>
                </div>
                
                <h3 class="text-xl font-bold mt-8 mb-4 text-red-400 flex items-center gap-2">
                    <i class="fas fa-running"></i>
                    Sport Test
                </h3>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="p-4 rounded-lg bg-gray-800/50 border border-gray-700">
                        <div class="flex items-center justify-between mb-3">
                            <span class="font-medium text-lg">Situps</span>
                            <span class="text-sm text-gray-400">15x</span>
                        </div>
                        <div class="flex items-center gap-3">
                            <input type="checkbox" id="situps" class="w-5 h-5 rounded text-red-600 focus:ring-red-500 bg-gray-700 border-gray-600">
                            <label for="situps" class="text-lg">Bestanden</label>
                        </div>
                    </div>
                    <div class="p-4 rounded-lg bg-gray-800/50 border border-gray-700">
                        <div class="flex items-center justify-between mb-3">
                            <span class="font-medium text-lg">Pushups</span>
                            <span class="text-sm text-gray-400">15x</span>
                        </div>
                        <div class="flex items-center gap-3">
                            <input type="checkbox" id="pushups" class="w-5 h-5 rounded text-red-600 focus:ring-red-500 bg-gray-700 border-gray-600">
                            <label for="pushups" class="text-lg">Bestanden</label>
                        </div>
                    </div>
                </div>
                
                <div class="flex justify-between mt-8">
                    <button type="button" class="btn-prev px-6 py-3 rounded-lg bg-gray-700 hover:bg-gray-600 font-medium flex items-center gap-2">
                        <i class="fas fa-arrow-left"></i>
                        Zurück
                    </button>
                    <button type="button" id="submitApplication" class="px-6 py-3 rounded-lg btn-danger font-medium flex items-center gap-2 pulse-red">
                        Bewerbung abschließen
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </form>
        </section>

        <!-- Result Section -->
        <section id="result" class="card p-6 hidden-section">
            <h2 class="text-2xl font-bold mb-6 text-red-400 flex items-center gap-2">
                <i class="fas fa-trophy"></i>
                Ergebnis
            </h2>
            
            <div id="resultContent" class="space-y-6">
                <div id="resultMessage" class="p-6 rounded-lg text-center">
                    <div class="text-4xl mb-4">
                        <i class="fas fa-question-circle"></i>
                    </div>
                    <h3 class="text-2xl font-bold mb-2">Bewertung läuft...</h3>
                    <p class="text-gray-300">Deine Bewerbung wird jetzt ausgewertet.</p>
                </div>
                
                <div class="p-4 rounded-lg bg-gray-800/50 border border-gray-700">
                    <h3 class="font-medium text-lg mb-3 text-red-400">Bewerbungszusammenfassung</h3>
                    <div class="space-y-3 text-sm">
                        <div class="flex justify-between">
                            <span class="text-gray-400">Name:</span>
                            <span id="summaryName" class="font-medium">-</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400">Alter & Herkunft:</span>
                            <span id="summaryAlter" class="font-medium">-</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400">Sporttest:</span>
                            <span id="summarySport" class="font-medium">-</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400">Bewertung:</span>
                            <span id="summaryScore" class="font-medium">-</span>
                        </div>
                    </div>
                </div>
                
                <div class="flex justify-between mt-8">
                    <button type="button" class="btn-prev px-6 py-3 rounded-lg bg-gray-700 hover:bg-gray-600 font-medium flex items-center gap-2">
                        <i class="fas fa-arrow-left"></i>
                        Zurück
                    </button>
                    <button type="button" id="newApplication" class="px-6 py-3 rounded-lg btn-danger font-medium flex items-center gap-2">
                        Neue Bewerbung
                        <i class="fas fa-redo"></i>
                    </button>
                </div>
            </div>
        </section>

        <!-- Admin Section -->
        <section id="admin" class="card p-6 hidden-section">
            <h2 class="text-2xl font-bold mb-6 text-blue-400 flex items-center gap-2">
                <i class="fas fa-lock"></i>
                Admin Bereich
            </h2>
            
            <div id="adminLogin" class="space-y-6">
                <div class="text-center mb-6">
                    <p class="text-gray-300">Bitte geben Sie den Admin-PIN ein, um auf den geschützten Bereich zuzugreifen.</p>
                </div>
                
                <div class="max-w-xs mx-auto">
                    <label class="block text-lg font-medium mb-2 text-center">Admin PIN</label>
                    <input type="password" id="adminPin" maxlength="4" class="w-full p-3 rounded-lg bg-gray-700 border border-gray-600 focus:border-blue-500 focus:outline-none pin-input" placeholder="****">
                    <p class="text-sm text-gray-400 mt-2 text-center">PIN: 1101</p>
                </div>
                
                <div class="text-center">
                    <button id="adminLoginBtn" class="px-6 py-3 rounded-lg bg-blue-600 hover:bg-blue-500 font-medium">
                        <i class="fas fa-sign-in-alt mr-2"></i>Einloggen
                    </button>
                </div>
                
                <div id="adminError" class="text-center text-red-400 hidden mt-4">
                    <i class="fas fa-exclamation-triangle mr-2"></i>Falscher PIN! Bitte versuchen Sie es erneut.
                </div>
            </div>
            
            <div id="adminContent" class="hidden space-y-6">
                <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-6">
                    <div>
                        <h3 class="text-xl font-bold text-blue-400">Bewerbungsübersicht</h3>
                        <p class="text-gray-300">Gespeicherte Bewerbungen: <span id="applicationCount">0</span></p>
                    </div>
                    <div class="flex gap-2">
                        <button id="exportData" class="px-4 py-2 rounded-lg bg-green-600 hover:bg-green-500 font-medium flex items-center gap-2">
                            <i class="fas fa-download mr-1"></i> Exportieren
                        </button>
                        <button id="adminLogout" class="px-4 py-2 rounded-lg bg-gray-700 hover:bg-gray-600 font-medium flex items-center gap-2">
                            <i class="fas fa-sign-out-alt mr-1"></i> Logout
                        </button>
                    </div>
                </div>
                
                <div class="overflow-x-auto">
                    <table class="admin-table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Alter & Herkunft</th>
                                <th>Sporttest</th>
                                <th>Bewertung</th>
                                <th>Datum</th>
                                <th>Aktionen</th>
                            </tr>
                        </thead>
                        <tbody id="adminTableBody">
                            <!-- Applications will be loaded here -->
                        </tbody>
                    </table>
                </div>
                
                <div id="noApplications" class="text-center py-8 text-gray-400">
                    <i class="fas fa-inbox text-4xl mb-4"></i>
                    <p>Keine Bewerbungen vorhanden.</p>
                </div>
            </div>
        </section>
    </div>

    <!-- Audio Elements for Effects -->
    <audio id="gunshotSound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-gun-shot-reverb-1005.mp3" type="audio/mpeg">
    </audio>
    
    <audio id="bloodSound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-blood-splash-1250.mp3" type="audio/mpeg">
    </audio>

    <script>
        // DOM Elements
        const tabBtns = document.querySelectorAll('.tab-btn');
        const sections = document.querySelectorAll('section');
        const progressFill = document.getElementById('progressFill');
        const nextBtns = document.querySelectorAll('.btn-next');
        const prevBtns = document.querySelectorAll('.btn-prev');
        const submitBtn = document.getElementById('submitApplication');
        const newAppBtn = document.getElementById('newApplication');
        const resultMessage = document.getElementById('resultMessage');
        const header = document.querySelector('header');
        const gunshotSound = document.getElementById('gunshotSound');
        const bloodSound = document.getElementById('bloodSound');
        
        // Admin Elements
        const adminPinInput = document.getElementById('adminPin');
        const adminLoginBtn = document.getElementById('adminLoginBtn');
        const adminError = document.getElementById('adminError');
        const adminLogin = document.getElementById('adminLogin');
        const adminContent = document.getElementById('adminContent');
        const adminTableBody = document.getElementById('adminTableBody');
        const applicationCount = document.getElementById('applicationCount');
        const noApplications = document.getElementById('noApplications');
        const exportDataBtn = document.getElementById('exportData');
        const adminLogoutBtn = document.getElementById('adminLogout');
        
        // Application State
        const ADMIN_PIN = "1101";
        let applicationState = {
            currentSection: 'standard',
            progress: 25,
            passed: false,
            isAdmin: false
        };
        
        // Load applications from localStorage
        let applications = JSON.parse(localStorage.getItem('kartellApplications')) || [];
        
        // Tab Navigation
        tabBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                const targetTab = btn.getAttribute('data-tab');
                
                // Special handling for admin tab
                if (targetTab === 'admin' && !applicationState.isAdmin) {
                    adminLogin.classList.remove('hidden');
                    adminContent.classList.add('hidden');
                }
                
                switchSection(targetTab);
            });
        });
        
        // Next Button Handlers
        nextBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                const currentSection = applicationState.currentSection;
                let nextSection;
                
                if (currentSection === 'standard') {
                    nextSection = 'situative';
                    applicationState.progress = 50;
                } else if (currentSection === 'situative') {
                    nextSection = 'stress';
                    applicationState.progress = 75;
                } else if (currentSection === 'stress') {
                    nextSection = 'result';
                    applicationState.progress = 100;
                }
                
                switchSection(nextSection);
                updateProgress();
            });
        });
        
        // Previous Button Handlers
        prevBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                const currentSection = applicationState.currentSection;
                let prevSection;
                
                if (currentSection === 'situative') {
                    prevSection = 'standard';
                    applicationState.progress = 25;
                } else if (currentSection === 'stress') {
                    prevSection = 'situative';
                    applicationState.progress = 50;
                } else if (currentSection === 'result') {
                    prevSection = 'stress';
                    applicationState.progress = 75;
                }
                
                switchSection(prevSection);
                updateProgress();
            });
        });
        
        // Submit Application
        submitBtn.addEventListener('click', () => {
            // Validate forms
            if (!validateForms()) {
                alert('Bitte füllen Sie alle erforderlichen Felder aus und bestätigen Sie den Sporttest.');
                return;
            }
            
            // Calculate result (random for demonstration)
            const situps = document.getElementById('situps').checked;
            const pushups = document.getElementById('pushups').checked;
            const sportPassed = situps && pushups;
            
            // For demonstration, we'll randomly decide if the application is accepted
            // In a real scenario, this would be based on the answers
            const randomScore = Math.floor(Math.random() * 100) + 1;
            applicationState.passed = randomScore > 40 && sportPassed;
            
            // Get form data
            const name = document.querySelector('#standardForm input[type="text"]').value;
            const alter = document.querySelectorAll('#standardForm input[type="text"]')[1].value;
            
            // Create application object
            const application = {
                id: Date.now(),
                name: name,
                alter: alter,
                sportTest: sportPassed ? 'Bestanden' : 'Nicht bestanden',
                score: randomScore,
                passed: applicationState.passed,
                date: new Date().toLocaleString('de-DE'),
                // In a real application, you would save all form data here
            };
            
            // Save application
            applications.push(application);
            localStorage.setItem('kartellApplications', JSON.stringify(applications));
            
            // Update summary
            document.getElementById('summaryName').textContent = name || '-';
            document.getElementById('summaryAlter').textContent = alter || '-';
            document.getElementById('summarySport').textContent = sportPassed ? 'Bestanden' : 'Nicht bestanden';
            document.getElementById('summaryScore').textContent = `${randomScore}%`;
            
            // Show result with delay for dramatic effect
            setTimeout(() => {
                showResult();
            }, 1500);
            
            // Switch to result section
            switchSection('result');
            applicationState.progress = 100;
            updateProgress();
        });
        
        // New Application
        newAppBtn.addEventListener('click', () => {
            // Reset forms
            document.querySelectorAll('form').forEach(form => form.reset());
            
            // Reset application state
            applicationState = {
                currentSection: 'standard',
                progress: 25,
                passed: false,
                isAdmin: applicationState.isAdmin
            };
            
            // Switch to standard section
            switchSection('standard');
            updateProgress();
            
            // Reset result message
            resultMessage.innerHTML = `
                <div class="text-4xl mb-4">
                    <i class="fas fa-question-circle"></i>
                </div>
                <h3 class="text-2xl font-bold mb-2">Bewertung läuft...</h3>
                <p class="text-gray-300">Deine Bewerbung wird jetzt ausgewertet.</p>
            `;
            resultMessage.className = 'p-6 rounded-lg text-center';
        });
        
        // Admin Login
        adminLoginBtn.addEventListener('click', () => {
            if (adminPinInput.value === ADMIN_PIN) {
                applicationState.isAdmin = true;
                adminLogin.classList.add('hidden');
                adminContent.classList.remove('hidden');
                adminError.classList.add('hidden');
                loadAdminData();
            } else {
                adminError.classList.remove('hidden');
                adminPinInput.value = '';
                adminPinInput.focus();
            }
        });
        
        // Allow Enter key for admin login
        adminPinInput.addEventListener('keyup', (e) => {
            if (e.key === 'Enter') {
                adminLoginBtn.click();
            }
        });
        
        // Admin Logout
        adminLogoutBtn.addEventListener('click', () => {
            applicationState.isAdmin = false;
            adminContent.classList.add('hidden');
            adminLogin.classList.remove('hidden');
            adminPinInput.value = '';
        });
        
        // Export Data
        exportDataBtn.addEventListener('click', () => {
            if (applications.length === 0) {
                alert('Keine Daten zum Exportieren vorhanden.');
                return;
            }
            
            // Convert to CSV
            const headers = ['ID', 'Name', 'Alter & Herkunft', 'Sporttest', 'Bewertung', 'Bestanden', 'Datum'];
            const csvData = applications.map(app => [
                app.id,
                `"${app.name}"`,
                `"${app.alter}"`,
                app.sportTest,
                `${app.score}%`,
                app.passed ? 'Ja' : 'Nein',
                `"${app.date}"`
            ]);
            
            const csvContent = [headers, ...csvData].map(row => row.join(',')).join('\n');
            
            // Create download link
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.setAttribute('download', `kartell_bewerbungen_${new Date().toISOString().split('T')[0]}.csv`);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        });
        
        // Switch Section Function
        function switchSection(sectionId) {
            // Update tabs
            tabBtns.forEach(btn => {
                if (btn.getAttribute('data-tab') === sectionId) {
                    btn.classList.remove('bg-gray-800', 'hover:bg-gray-700', 'bg-blue-800', 'hover:bg-blue-700');
                    
                    if (sectionId === 'admin') {
                        btn.classList.add('tab-active');
                    } else {
                        btn.classList.add('tab-active');
                    }
                } else {
                    btn.classList.remove('tab-active');
                    
                    if (btn.getAttribute('data-tab') === 'admin') {
                        btn.classList.add('bg-blue-800', 'hover:bg-blue-700');
                    } else {
                        btn.classList.add('bg-gray-800', 'hover:bg-gray-700');
                    }
                }
            });
            
            // Update sections
            sections.forEach(section => {
                if (section.id === sectionId) {
                    section.classList.remove('hidden-section');
                    section.classList.add('active-section');
                } else {
                    section.classList.remove('active-section');
                    section.classList.add('hidden-section');
                }
            });
            
            // Update application state
            applicationState.currentSection = sectionId;
        }
        
        // Update Progress Bar
        function updateProgress() {
            progressFill.style.width = `${applicationState.progress}%`;
        }
        
        // Validate Forms
        function validateForms() {
            // Check if all required fields are filled
            const requiredInputs = document.querySelectorAll('input[required], textarea[required]');
            let allFilled = true;
            
            requiredInputs.forEach(input => {
                if (!input.value.trim()) {
                    allFilled = false;
                    input.classList.add('border-red-500');
                } else {
                    input.classList.remove('border-red-500');
                }
            });
            
            // Check sport test
            const situps = document.getElementById('situps').checked;
            const pushups = document.getElementById('pushups').checked;
            const sportPassed = situps && pushups;
            
            return allFilled && sportPassed;
        }
        
        // Show Result
        function showResult() {
            if (applicationState.passed) {
                resultMessage.innerHTML = `
                    <div class="text-4xl mb-4 text-green-400">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <h3 class="text-2xl font-bold mb-2 text-green-400">BESTANDEN</h3>
                    <p class="text-gray-300 mb-4">Herzlichen Glückwunsch! Du hast die Bewerbung bestanden.</p>
                    <p class="text-sm text-gray-400">Du wirst in Kürze kontaktiert.</p>
                `;
                resultMessage.classList.add('result-passed');
                
                // Show gunshot effect after a delay
                setTimeout(() => {
                    showGunshotEffect();
                }, 1000);
            } else {
                resultMessage.innerHTML = `
                    <div class="text-4xl mb-4 text-red-400">
                        <i class="fas fa-times-circle"></i>
                    </div>
                    <h3 class="text-2xl font-bold mb-2 text-red-400">NICHT BESTANDEN</h3>
                    <p class="text-gray-300 mb-4">Leider hast du die Bewerbung nicht bestanden.</p>
                    <p class="text-sm text-gray-400">Deine Antworten erfüllen nicht unsere Anforderungen.</p>
                `;
                resultMessage.classList.add('result-failed');
                
                // Show blood effect after a delay
                setTimeout(() => {
                    showBloodEffect();
                }, 1000);
            }
        }
        
        // Load Admin Data
        function loadAdminData() {
            applicationCount.textContent = applications.length;
            
            if (applications.length === 0) {
                adminTableBody.innerHTML = '';
                noApplications.classList.remove('hidden');
                return;
            }
            
            noApplications.classList.add('hidden');
            
            // Sort applications by date (newest first)
            const sortedApplications = [...applications].sort((a, b) => b.id - a.id);
            
            // Populate table
            adminTableBody.innerHTML = sortedApplications.map(app => `
                <tr>
                    <td>${app.name}</td>
                    <td>${app.alter}</td>
                    <td>${app.sportTest}</td>
                    <td>${app.score}%</td>
                    <td>${app.date}</td>
                    <td>
                        <button class="delete-btn px-3 py-1 rounded bg-red-600 hover:bg-red-500 text-sm" data-id="${app.id}">
                            <i class="fas fa-trash mr-1"></i> Löschen
                        </button>
                    </td>
                </tr>
            `).join('');
            
            // Add event listeners to delete buttons
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const id = parseInt(e.target.closest('.delete-btn').getAttribute('data-id'));
                    deleteApplication(id);
                });
            });
        }
        
        // Delete Application
        function deleteApplication(id) {
            if (confirm('Möchten Sie diese Bewerbung wirklich löschen?')) {
                applications = applications.filter(app => app.id !== id);
                localStorage.setItem('kartellApplications', JSON.stringify(applications));
                loadAdminData();
            }
        }
        
        // Show Gunshot Effect (for passed application)
        function showGunshotEffect() {
            // Create bullet hole
            const bulletHole = document.createElement('div');
            bulletHole.className = 'bullet-hole';
            
            // Random position on header (simulating shoulder shot)
            const headerRect = header.getBoundingClientRect();
            const x = 30 + Math.random() * 20; // Left side of header
            const y = 50 + Math.random() * 30; // Shoulder area
            
            bulletHole.style.left = `${x}%`;
            bulletHole.style.top = `${y}%`;
            
            header.appendChild(bulletHole);
            
            // Play gunshot sound
            gunshotSound.currentTime = 0;
            gunshotSound.play().catch(e => console.log("Audio play failed:", e));
            
            // Show bullet hole
            setTimeout(() => {
                bulletHole.classList.add('active');
            }, 100);
            
            // Show message
            setTimeout(() => {
                alert('Da du bestanden hast: Du wirst einmal in die Schulter geschossen (simuliert).');
            }, 800);
        }
        
        // Show Blood Effect (for failed application)
        function showBloodEffect() {
            // Add blood effect to header
            header.classList.add('active');
            
            // Play blood sound
            bloodSound.currentTime = 0;
            bloodSound.play().catch(e => console.log("Audio play failed:", e));
            
            // Show message
            setTimeout(() => {
                alert('Da du nicht bestanden hast: Du bekommst Bloodout (simuliert).');
            }, 1000);
            
            // Remove blood effect after animation
            setTimeout(() => {
                header.classList.remove('active');
            }, 2500);
        }
        
        // Initialize
        updateProgress();
    </script>
</body>
</html>
